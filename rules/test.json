[
	{
		"id":"malicious-referer-test",
		"phase":2,
		"pattern":"(?i)malicious-referer",
		"targets":[
			"HEADERS:Referer"
		],
		"severity":"HIGH",
		"action":"block",
		"score":5,
		"description":"Block requests with malicious Referer headers"
	},
	{
		"id":"scanner-detection",
		"phase":1,
		"pattern":"(?i)(?:sqlmap|acunetix|nikto|nessus|netsparker|nmap|dirbuster|w3af|openvas|burpsuite|webinspect|qualys|commix|zap|arachni|gobuster|hydra|metasploit|zgrab|masscan|wfuzz|crackmapexec|nuclei|shodan|censys|dirsearch|ffuf|vega|skipfish|wpscan|whatweb|dirmap)",
		"targets":[
			"USER_AGENT"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":9,
		"description":"Block requests from known security scanners based on User-Agent."
	},
	{
		"id":"xss",
		"phase":2,
		"pattern":"(?i)(?:<script[^>]*>|<img[^>]*\\s+onerror=|javascript:|data:|vbscript:|<svg[^>]*\\s+onload=|alert\\(|document\\.(?:cookie|location)|eval\\(|base64_(?:encode|decode)|expression\\(|\\b(?:on(?:mouse(?:over|out|down|up|move)|focus|blur|click|key(?:press|down|up)|load|error|submit|reset|change))\\s*=|\\bstyle\\s*=)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":6,
		"description":"Block XSS attempts using HTML tags, event handlers, javascript: protocol."
	},
	{
		"id":"path-traversal",
		"phase":2,
		"pattern":"(?:\\.\\.[/\\\\]|\\.\\./|\\.\\.\\\\/|%2e%2e[/\\\\]|%2e%2e/|%2e%2e%5c|%252e%252e|\\b(?:etc(?:\\/|%2F)(?:passwd|shadow|hosts)|(?:proc|sys)(?:\\/|%2F)(?:self(?:\\/|%2F)environ|cmdline)|boot(?:\\/|%2F)grub(?:\\/|%2F)grub.cfg)\\b)",
		"targets":[
			"PATH",
			"ARGS",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":9,
		"description":"Block path traversal attempts and direct access to sensitive files."
	},
	{
		"id":"rce-commands",
		"phase":2,
		"pattern":"(?i)(?:\\b(?:cat|base64|whoami|echo|curl|wget|bash|sh|python|perl)\\b)",
		"targets":[
			"ARGS",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":3,
		"description":"Block common commands used in RCE attempts."
	},
	{
		"id":"rce-sensitive-files",
		"phase":2,
		"pattern":"(?i)(?:\\b(?:/etc/passwd|/etc/shadow)\\b)",
		"targets":[
			"ARGS",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":4,
		"description":"Block attempts to access sensitive files."
	},
	{
		"id":"rce-separators",
		"phase":2,
		"pattern":"(?i)(?:`[^`]+`|\\b(?:;|\\|\\||&&|\\n|%0a|%0d)\\s*(?:rm|cat|echo|curl|wget|python|php|jsp|cmd|exec|system|passthru|shell_exec|exec|system|popen|pcntl_exec))",
		"targets":[
			"ARGS",
			"HEADERS:User-Agent",
			"HEADERS:Referer"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block command separators followed by specific commands in ARGS and selected headers."
	},
	{
		"id":"header-attacks",
		"phase":2,
		"pattern":"(?i)(?:1'\\s+OR\\s+'1'='1|<script[^>]*>|\\.\\.\\/\\.\\.\\/etc\\/passwd|1'\\s+UNION\\s+SELECT\\s+NULL--|\\b(?:select|insert|update|delete|drop|alter)\\b[\\s\\S]*?\\b(?:from|into|where|table)\\b|\\bunion\\b[\\s\\S]*?\\bselect\\b|'\\s*(?:and|or)\\s*['\\d]+\\s*(?:=|[<>]=?|!=)\\s*['\\d]+|\\)\\s*(?:and|or)\\s*\\([\\d]+\\s*(?:=|[<>]=?|!=)\\s*[\\d]+\\)|\\b(?:sleep|benchmark|waitfor\\s+delay)\\s*\\()",
		"targets":[
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block SQL injection, XSS, and path traversal attempts in headers."
	},
	{
		"id":"sensitive-files",
		"phase":1,
		"pattern":"(?i)(?:/\\.git/(?:HEAD|index|config|refs|objects)|/\\.env(?:\\.local|\\.dev|\\.prod)?$|/\\.htaccess$|/\\.htpasswd$|/\\.svn/|/\\.DS_Store$|\\/WEB-INF\\/|\\/WEB-INF\\/web.xml|\\/META-INF\\/)",
		"targets":[
			"PATH",
			"URI"
		],
		"severity":"HIGH",
		"action":"block",
		"score":9,
		"description":"Block access to sensitive files and directories."
	},
	{
		"id":"unusual-paths",
		"phase":1,
		"pattern":"(?i)(?:/wp-admin|/phpmyadmin|/admin|/login|/cgi-bin|/shell|/backdoor|/cmd|/exec|/bin/(?:sh|bash|zsh)|/console|/setup|/test)",
		"targets":[
			"PATH"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":7,
		"description":"Block requests to unusual or suspicious paths."
	},
	{
		"id":"block-bad-bots",
		"phase":1,
		"pattern":"(?i)(?:sqlmap|acunetix|nikto|nessus|netsparker|dirbuster|burpsuite|wpscan|nuclei|qualys|arachni|openvas|zap|vega|skipfish|w3af|gobuster|owasp zap|webinspect|appscan|detectify|nessuscloud|retire\\.js|fortify|checkmarx|veracode|snyk|rapid7|nexpose|insightvm|hydra|medusa|ncrack|john the ripper|hashcat|patator|masscan|shodan|censys|whatweb|dirmap|nmap|amap|zmap|theharvester|recon-ng|fierce|metasploit|commix|crackmapexec|cobalt strike|empire|powersploit|httrack|wget|curl|scrapy|beautifulsoup|phantomjs|headlesschrome|puppeteer|grabber|node-fetch|axios|bugcrowd|hackerone|intruder|selenium|openscap|ffuf|webscarab|sublist3r|dirsearch|sql ninja|eyewitness|gau|waybackurls|assetfinder|ahrefsbot|mj12bot|semrushbot|dotbot|rogerbot|exabot|yandexbot|baiduspider|googlebot-image|bingbot|go-http-client|python-requests|okhttp|lwp-request|libwww-perl|kube-hunter|cloudmapper|pacu|dirb|uniscan|vega|arachni|xsser|davtest|jexboss|joomscan|droopescan|cmsmap|xsstrike|thesprawl|cloudgoat|sqlmapapi|wpscanapi|impacket|responder|bloodhound|mimikatz|pupy|veil-framework|evilginx|mitmproxy|bettercap|playwright|nightmare|zombie\\.js|splash)",
		"targets":[
			"USER_AGENT"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":9,
		"description":"Block requests from known security scanners and bad bots."
	},
	{
		"id":"sql-injection",
		"phase":2,
		"pattern":"(?i)((\\b(?:union|select|insert|update|delete|drop|alter|create|truncate|grant|revoke)\\b\\s+(?:all|distinct|column|table|database|user|index|from|into|where|values|set|order|group|by|having|limit|offset|on|join|inner|left|right|full|cross|outer)\\b)|(\\b(?:exec|xp_cmdshell|sp_)\\b)|((\\/\\*[\\s\\S]*?(?:select|insert|update|delete|drop|alter|create|truncate|grant|revoke)[\\s\\S]*?\\*\\/)|(--\\s+.*?(?:select|insert|update|delete|drop|alter|create|truncate|grant|revoke).*\\n))|(['\"`].*?(?:select|insert|update|delete|drop|alter|create|truncate|grant|revoke).*?['\"`]\\s*(?:=|<>|like|in|is|between)\\s*['\"`].*?['\"`])|((\\b(?:and|or|not)\\b\\s+[\\d\\w]+\\s*(?:=|<>|like|in|is|between)\\s*[\\d\\w]+)|(\\b(?:sleep|benchmark|waitfor\\s+delay)\\s*\\()|((\\b(?:case)\\b[\\s\\S]*?(?:when)[\\s\\S]*?(?:then)[\\s\\S]*?(?:end)\\b))|(\\/\\*!.*?\\*\\/)|(--\\s+.*?(?:\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})|'\\s*or\\s*\\d\\s*=\\s*\\d)|((?:char|concat|group_concat|hex|substr|substring)\\s*\\(\\s*(?:(?:0x[0-9a-fA-F]+)|(?:['\"`][\\w\\s\\W]+['\"`]))\\s*(?:\\s*,\\s*(?:(?:0x[0-9a-fA-F]+)|(?:['\"`][\\w\\s\\W]+['\"`]))?\\s*)*\\s*\\)))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block SQL injection attempts using refined keyword matching and bypass detection."
	},
	{
		"id":"xss-detection",
		"phase":2,
		"pattern":"(?i)(<script\\b[^>]*>.*?<\\/script>|<iframe\\b[^>]*>.*?<\\/iframe>|<img\\b[^>]*src\\s*=\\s*[\"']?.*?\\/?>|<body\\b[^>]*onload\\s*=\\s*[\"']?.*?(?:[\"']?)(?:>|\\s))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block Cross-Site Scripting attempts using common tags."
	},
	{
		"id":"xss-protocols",
		"phase":2,
		"pattern":"(?i)(javascript:|data:|vbscript:|livescript:|mocha:|about:|file:|blob:|magnet:)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block Cross-Site Scripting attempts using protocols."
	},
	{
		"id":"command-injection",
		"phase":2,
		"pattern":"(?i)(\\b(wget|curl|bash|sh|cmd|powershell|python|perl|ruby|php)\\b|\\s*;\\s*\\b(rm|ls|cat|echo|find|grep|awk|sed|netstat|ps|kill|shutdown|reboot|del|erase|attrib|taskkill|reg)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block command injection attempts."
	},
	{
		"id":"sensitive-file-access",
		"phase":2,
		"pattern":"(?i)(\\.\\./|\\.\\\\\\\\|(etc|proc|root|windows|system32|boot\\.ini|win\\.ini|passwd|shadow|config\\.inc\\.php|wp-config\\.php|dbconfig\\.php))",
		"targets":[
			"PATH"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":9,
		"description":"Block attempts to access sensitive system files."
	},
	{
		"id":"php-injection",
		"phase":2,
		"pattern":"(?i)(php://input|php://filter|base64_decode|eval\\(|assert\\(|system\\(|passthru\\(|exec\\(|shell_exec\\(|proc_open\\(|popen\\(|pcntl_exec\\(|preg_replace\\(.*?\\/e\\)|create_function\\()",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":9,
		"description":"Block attempts to inject malicious php code."
	},
	{
		"id":"auth-bypass-params",
		"phase":2,
		"pattern":"(?i)(\\b(admin|login|password|user|username|email|token|secret|key)\\b\\s*=\\s*.*?(?=[&?#]|$))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":6,
		"description":"Block common auth bypass parameters in requests."
	},
	{
		"id":"long-request-detection",
		"phase":1,
		"pattern":".{1000,}",
		"targets":[
			"BODY",
			"ARGS",
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block extremely long requests."
	},
	{
		"id":"obfuscated-php",
		"phase":2,
		"pattern":"(?i)(eval\\(|base64_decode|gzinflate|str_rot13|create_function|shell_exec|system|exec|passthru|preg_replace\\s*\\(.*?\\/e|assert)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block obfuscated php code."
	},
	{
		"id":"malicious-file-extensions",
		"phase":1,
		"pattern":"(?i)\\.(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm)(\\?|$)",
		"targets":[
			"PATH",
			"ARGS",
			"HEADERS:Content-Disposition"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block requests for known malicious file extensions."
	},
	{
		"id":"command-execution-win",
		"phase":2,
		"pattern":"(?i)(cmd\\.exe|/bin/sh|/bin/bash|whoami|pwd|ls\\s+-la|ipconfig|ifconfig|net\\s+user|tasklist|ps\\s+aux|uname\\s+-a|id|ver|netstat\\s+-an|arp\\s+-a|route\\s+print|taskmgr)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block command execution."
	},
	{
		"id":"encoded-payloads",
		"phase":2,
		"pattern":"(?i)([a-zA-Z0-9+/]{40,}(?:={1,2})?$)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block requests with potential base64-like encoded payloads."
	},
	{
		"id":"hex-encoded-payloads",
		"phase":2,
		"pattern":"(?i)(\\\\x[0-9a-f]{2}){10,}",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block requests with hex encoded payloads."
	},
	{
		"id":"javascript-payloads",
		"phase":2,
		"pattern":"(?i)(\\b(?:document\\.(?:cookie|location|write)|window\\.(?:location|open)|eval|setTimeout|setInterval|XMLHttpRequest|fetch|navigator\\.userAgent|localStorage|sessionStorage|replace|postMessage|sendBeacon|atob|btoa|unescape|escape|decodeURIComponent|encodeURIComponent|innerHTML)\\b\\s*\\()",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block requests with potential JavaScript payloads using function call patterns."
	},
	{
		"id":"malicious-file-extensions-extended",
		"phase":1,
		"pattern":"(?i)\\.(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm|swf|ps1|vbs|vb|msi|app|com|scr|cpl|drv|js)(\\?|$)",
		"targets":[
			"PATH",
			"ARGS",
			"HEADERS:Content-Disposition"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block requests for known malicious file extensions extended list."
	},
	{
		"id":"function-detection",
		"phase":2,
		"pattern":"(?i)(function\\s*\\(\\) \\{.*?\\}|<\\?php\\s+.*?\\?>|<\\?=\\s+.*?\\?>|[\\w]+\\s*=\\s*function\\s*\\(.*?\\)\\s*\\{.*?\\})",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block requests with functions."
	},
	{
		"id":"filename-extension",
		"phase":2,
		"pattern":"(?i)(filename\\s*=\\s*\".*\\.(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm|swf|ps1|vbs|vb|msi|app|com|scr|cpl|drv))",
		"targets":[
			"HEADERS:Content-Disposition"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block requests with malicious filename extensions"
	},
	{
		"id":"archive-file-extension",
		"phase":1,
		"pattern":"(?i)\\.(zip|rar|7z|tar|gz|bz2|xz|tgz|apk|iso|img|dmg|vhd|ova|vmdk|cab|ace|arj|lzh|sfx)(\\?|$)",
		"targets":[
			"PATH",
			"ARGS",
			"HEADERS:Content-Disposition"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block requests for archive file extensions."
	},
	{
		"id":"command-execution-php",
		"phase":2,
		"pattern":"(?i)(\\b(echo|print|die|exit|system|exec|passthru|proc_open|popen|pcntl_exec|shell_exec|`|\\\\)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Block command execution patterns."
	},
	{
		"id":"sql-keywords",
		"phase":2,
		"pattern":"(?i)(\\b(union|select|insert|update|delete|drop|alter|create|truncate|grant|revoke)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":5,
		"description":"Block SQL keywords."
	},
	{
		"id":"sql-logical-bypass",
		"phase":2,
		"pattern":"(?i)(\\b(and|or|not)\\b\\s+[\\d\\w]+\\s*(=|<>|like|in|is|between)\\s*[\\d\\w]+)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":5,
		"description":"Block SQL logical bypass."
	},
	{
		"id":"injection-tags",
		"phase":2,
		"pattern":"(?i)(\\b(iframe|embed|object|meta|script|link|style|img|applet|frame|frameset|video|audio|source)\\b.*?\\b(src|data|href|code|value)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block use of HTML injection tags."
	},
	{
		"id":"local-addresses",
		"phase":2,
		"pattern":"(?i)(\\b(127\\.0\\.0\\.1|192\\.168|10\\.|172\\.(1[6-9]|2[0-9]|3[0-1])|0\\.0\\.0\\.0)\\b)",
		"targets":[
			"PATH"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block requests with local IPs in the request path."
	},
	{
		"id":"auth-bypass-common-creds",
		"phase":2,
		"pattern":"(?i)(\\b(admin|root|test|guest|user|administrator)\\b.*?\\b(password|passwd|pwd|secret|key|token|credential)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":6,
		"description":"Block common credential parameters in requests."
	},
	{
		"id":"malicious-url-extensions",
		"phase":2,
		"pattern":"(?i)(\\b(https?|ftp|sftp|ftps|smb|cifs|dav|rdp):\\/\\/.*?\\b(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm|swf|ps1|vbs|vb|msi|app|com|scr|cpl|drv)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block malicious URL extensions in the requests."
	},
	{
		"id":"content-type-attacks",
		"phase":2,
		"pattern":"(?i)(\\b(content-type|content-length|transfer-encoding)\\b.*?\\b(multipart|chunked|base64|binary)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":5,
		"description":"Block content type injection."
	},
	{
		"id":"encoding-attacks",
		"phase":2,
		"pattern":"(?i)(\\b(accept-encoding)\\b.*?\\b(?:\\s*,\\s*(?:zlib|gzip|deflate|compress|br|x-compress)\\s*,|\\s*(?:zlib|gzip|deflate|compress|br|x-compress)\\s*\\z)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":5,
		"description":"Block attempts to abuse encoding in the Accept-Encoding header."
	},
	{
		"id":"auth-header-bypass",
		"phase":2,
		"pattern":"(?i)(\\b(cookie|set-cookie|authorization)\\b.*?\\b(admin|root|test|guest|user|sessionid|token|jwt|bearer|key)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":6,
		"description":"Block attempts to inject auth headers."
	},
	{
		"id":"malicious-referer",
		"phase":2,
		"pattern":"(?i)(\\b(referer|origin)\\b.*?\\b(https?:\\/\\/.*?\\.(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm|swf|ps1|vbs|vb|msi|app|com|scr|cpl|drv))\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":6,
		"description":"Block requests with referers to malicious file extensions."
	},
	{
		"id":"malicious-content-disposition",
		"phase":2,
		"pattern":"(?i)(\\b(content-disposition)\\b.*?\\b(filename\\s*=\\s*\".*?\\.(php[3457]?|phtml|exe|dll|bat|sh|py|pl|jsp|asp|aspx|jar|war|hta|cgi|rb|perl|cfm|swf|ps1|vbs|vb|msi|app|com|scr|cpl|drv))\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block content-disposition header with malicious filename extensions."
	},
	{
		"id":"connection-header-connection",
		"phase":2,
		"pattern":"(?i)^\\s*connection\\s*:\\s*(keep-alive|close|upgrade)(?!\\w)",
		"targets":[
			"HEADERS.Connection"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block attempts to inject or modify Connection header."
	},
	{
		"id":"connection-header-keep-alive",
		"phase":2,
		"pattern":"(?i)^\\s*keep-alive\\s*:\\s*(keep-alive|close|upgrade)(?!\\w)",
		"targets":[
			"HEADERS.Keep-Alive"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block attempts to inject or modify Keep-Alive header."
	},
	{
		"id":"proxy-detection-header",
		"phase":2,
		"pattern":"(?i)(\\b(proxy-connection|via|x-forwarded-for)\\b.*?\\b(127\\.0\\.0\\.1|localhost|0\\.0\\.0\\.0|::1)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block proxy connections through header."
	},
	{
		"id":"cors-bypass-header",
		"phase":2,
		"pattern":"(?i)(\\b(access-control-allow-origin|access-control-allow-methods|access-control-allow-headers)\\b.*?\\b(\\*|https?:\\/\\/.*?)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block malicious cors header."
	},
	{
		"id":"server-information-exposure",
		"phase":2,
		"pattern":"(?i)(\\b(server|server-status|server-info|server-signature|x-powered-by|x-aspnet-version)\\b.*?\\b(apache|nginx|iis|lighttpd|tomcat|jws|weblogic|websphere|jetty|glassfish|node\\.js)\\b)",
		"targets":[
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Block attempts to get server info."
	},
	{
		"id":"php-information-disclosure",
		"phase":2,
		"pattern":"(?i)(\\b(phpinfo|phpversion|php_uname|php_sapi_name|php_ini_loaded_file|version_compare|get_cfg_var|get_current_user|getmyuid|getenv|get_loaded_extensions)\\b.*?\\b(\\(|\\)\\)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to get PHP information."
	},
	{
		"id":"php-configuration-exposure",
		"phase":2,
		"pattern":"(?i)(\\b(open_basedir|disable_functions|allow_url_fopen|allow_url_include|auto_prepend_file|auto_append_file|expose_php|register_globals|magic_quotes_gpc|magic_quotes_runtime|magic_quotes_sybase)\\b.*?\\b(=\\s*.*?)\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to get php configuration."
	},
	{
		"id":"error-reporting-exploitation",
		"phase":2,
		"pattern":"(?i)(\\b(error_log|syslog|mail|error_reporting|debug_backtrace|trigger_error|set_error_handler|restore_error_handler)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to exploit error handling."
	},
	{
		"id":"php-ini-exploitation",
		"phase":2,
		"pattern":"(?i)(\\b(ini_set|ini_get|ini_restore|set_time_limit|memory_limit|realpath_cache_size|realpath_cache_ttl|extension_loaded|dl)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to exploit PHP ini functions."
	},
	{
		"id":"header-manipulation",
		"phase":2,
		"pattern":"(?i)(\\b(header|setcookie|session_start|http_response_code|ob_start|ob_flush|ob_end_clean|ob_get_contents|ob_get_length|ob_get_level|ob_list_handlers|ob_clean|flush)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to manipulate headers."
	},
	{
		"id":"include-files-php",
		"phase":2,
		"pattern":"(?i)(\\b(include|require|include_once|require_once|file|highlight_file|show_source)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to include files via php functions."
	},
	{
		"id":"file-operation-php",
		"phase":2,
		"pattern":"(?i)(\\b(file_get_contents|file_put_contents|fopen|fclose|fread|fwrite|fputs|fgets|fgetss|file_exists|is_dir|is_file|is_readable|is_writable|disk_free_space|disk_total_space)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to use file operation functions in php."
	},
	{
		"id":"directory-operations-php",
		"phase":2,
		"pattern":"(?i)(\\b(readfile|readdir|scandir|glob|file|parse_ini_file|parse_str|parse_url|get_headers|getimagesize|gethostbyaddr|gethostbyname|getmxrr)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block directory operations via PHP."
	},
	{
		"id":"filesystem-operations-php",
		"phase":2,
		"pattern":"(?i)(\\b(unlink|rmdir|mkdir|rename|copy|move|symlink|link|touch|chown|chgrp|chmod|umask)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to use filesystem operations in php."
	},
	{
		"id":"advanced-file-operations-php",
		"phase":2,
		"pattern":"(?i)(\\b(copy|move_uploaded_file|chmod|chown|chgrp|clearstatcache|tempnam|tmpfile|get_magic_quotes_gpc|get_magic_quotes_runtime|set_time_limit|pack|unpack|system_exec)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block advanced file operation functions."
	},
	{
		"id":"data-manipulation-php",
		"phase":2,
		"pattern":"(?i)(\\b(serialize|unserialize|json_encode|json_decode|yaml_parse|base64_encode|base64_decode|gzcompress|gzuncompress|gzencode|gzdecode|gzdeflate|gzinflate|bzcompress|bzdecompress|iconv|mb_convert_encoding|urlencode|urldecode|htmlentities|htmlspecialchars|htmlspecialchars_decode)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to manipulate data via php."
	},
	{
		"id":"hashing-php",
		"phase":2,
		"pattern":"(?i)(\\b(hash|md5|sha1|sha256|sha512|crypt|password_hash|password_verify|hash_file|hash_hmac|hash_hmac_file|crc32|hash_init|hash_update|hash_final|hash_copy|hash_algos)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to use hashing functions in php."
	},
	{
		"id":"crypto-php",
		"phase":2,
		"pattern":"(?i)(\\b(openssl_encrypt|openssl_decrypt|mcrypt_encrypt|mcrypt_decrypt|sodium_crypto_secretbox|sodium_crypto_box|sodium_crypto_aead_chacha20poly1305_ietf_encrypt|sodium_crypto_aead_chacha20poly1305_ietf_decrypt|sodium_crypto_sign|sodium_crypto_sign_open|ssh2_connect|ssh2_exec|ssh2_scp_send|ssh2_scp_recv|openssl_sign|openssl_verify|openssl_seal|openssl_open)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to use crypto functions in php."
	},
	{
		"id":"password-hashing-php",
		"phase":2,
		"pattern":"(?i)(\\b(password_hash|password_verify|password_needs_rehash|password_algos|password_get_info)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to use password hashing functions."
	},
	{
		"id":"session-manipulation-php",
		"phase":2,
		"pattern":"(?i)(\\b(session_id|session_regenerate_id|session_destroy|session_reset|session_create_id|session_encode|session_decode|session_write_close|session_unset|session_commit|session_abort|session_start|session_name|session_module_name|session_save_path|session_cache_expire|session_cache_limiter|session_set_cookie_params|session_get_cookie_params|session_status|session_set_save_handler|session_gc)\\b.*?\\b(\\(.*?\\))\\b)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":7,
		"description":"Block attempts to manipulate session via php."
	},
	{
		"id":"executable-signature",
		"phase":1,
		"pattern":"MZ.{20,}PE",
		"targets":[
			"BODY",
			"ARGS",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Detect Executable Signature in response."
	},
	{
		"id":"assembly-operations",
		"phase":2,
		"pattern":"(?i)(\\b(xor|rot|shift|add|sub|mul|div)\\b\\s+[\\w]+[\\s,]+[\\w]+[\\s,]+[\\w]+[\\s,]+[\\w]+)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"MEDIUM",
		"action":"block",
		"score":4,
		"description":"Detect assembly operations."
	},
	{
		"id":"hex-encoded-payloads-extended",
		"phase":2,
		"pattern":"(?i)(\\\\x[0-9a-f]{2}){50,}",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Detect long hex encoded strings."
	},
	{
		"id":"powershell-execution",
		"phase":2,
		"pattern":"(powershell\\.exe\\s+(.*?)\\s*(&|\\||;))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Detect powershell execution."
	},
	{
		"id":"mshta-execution",
		"phase":2,
		"pattern":"(mshta\\s+.*?\\.hta)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Detect mshta execution."
	},
	{
		"id":"regsvr32-execution",
		"phase":2,
		"pattern":"(regsvr32\\s+.*?\\.dll)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS"
		],
		"severity":"HIGH",
		"action":"block",
		"score":8,
		"description":"Detect regsvr32 execution."
	},
	{
		"id":"log4j-exploit-v2",
		"phase":2,
		"pattern":"(?i)(\\$\\{(?:jndi|env|sys|java|lower|upper|date|ctx|threadcontext|marker):[^}]+\\}|\\$\\{.*?:.*\\})",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects Log4j exploit attempts by looking for JNDI lookup patterns and variations in request bodies, headers, and URIs, including support for lowercase, uppercase, and mixed cases. This rule attempts to mitigate CVE-2021-44228 and related vulnerabilities. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-specific-v1",
		"phase":2,
		"pattern":"(?i)(\\$\\{(?:jndi:(?:rmi|ldap|dns):[^}]+\\}|env:(?:[a-zA-Z0-9_\\-]+)?\\}|sys:(?:[a-zA-Z0-9_\\-]+)?\\}|java:(?:[a-zA-Z0-9_\\-]+)?\\}|lower:(?:[a-zA-Z0-9_\\-]+)?\\}|upper:(?:[a-zA-Z0-9_\\-]+)?\\}))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects specific Log4j exploit attempts using JNDI (RMI, LDAP, DNS), environment variables, system properties, and lower/uppercase lookups in request bodies, headers, and URIs. This rule is designed to mitigate CVE-2021-44228 and related vulnerabilities with increased specificity. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-comprehensive-v1",
		"phase":2,
		"pattern":"(?i)(\\$\\{(?:jndi:(?:ldap|rmi|dns|ldaps):[^}]+\\}|env:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|sys:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|java:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|lower:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|upper:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|date:(?:[a-zA-Z0-9_\\-\\.\\:]+)?\\}|.*?\\:.*?\\}))",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects a wide range of Log4j exploit attempts, including JNDI (LDAP, RMI, DNS, LDAPS), environment variables, system properties, lower/uppercase, date lookups, and partial lookups in request bodies, headers, and URIs. This rule mitigates CVE-2021-44228 and related vulnerabilities. It is designed for broad coverage and will block requests containing these patterns. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-base64-v1",
		"phase":2,
		"pattern":"(?i)(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?\\$\\{(?:jndi|env|sys|java|lower|upper|date|ctx|threadcontext|marker):[^}]+\\}",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects Base64-encoded strings that contain Log4j exploit patterns (e.g., ${jndi:...}). This rule is designed to block malicious Base64-encoded payloads while minimizing false positives. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-url-encoded-v1",
		"phase":2,
		"pattern":"(?i)(%24%7B(?:jndi|env|sys|java|lower|upper|date|ctx|threadcontext|marker):[^}]+%7D)",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects URL-encoded Log4j exploit patterns (e.g., %24%7Bjndi:...%7D). This rule is designed to block malicious URL-encoded payloads while minimizing false positives. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-obfuscated-v1",
		"phase":2,
		"pattern":"(?i)(\\$\\{(?:\\${.*?:.*}|[^}]+):[^}]+\\})",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects obfuscated Log4j exploit patterns, including nested lookups and complex variations. This rule is designed to block advanced evasion techniques. If triggered, investigate the source of the request immediately."
	},
	{
		"id":"log4j-exploit-partial-lookup-v1",
		"phase":2,
		"pattern":"(?i)(\\$\\{::-jndi:[^}]+\\})",
		"targets":[
			"ARGS",
			"BODY",
			"HEADERS",
			"URI"
		],
		"severity":"CRITICAL",
		"action":"block",
		"score":10,
		"description":"Detects partial Log4j exploit patterns (e.g., ${::-jndi:...}). This rule is designed to block partial lookup attacks. If triggered, investigate the source of the request immediately."
	}
]
