[
    {
        "id": "whitelist-001",
        "phase": 1,
        "pattern": "^/$",
        "targets": ["PATH"],
        "severity": "LOW",
        "action": "pass",
        "score": 0,
        "mode": "pass"
    },
    {
        "id": "whitelist-002",
        "phase": 1,
        "pattern": "^/(?:about|health|status|ping)$",
        "targets": ["PATH"],
        "severity": "LOW",
        "action": "pass",
        "score": 0,
        "mode": "pass"
    },
    {
        "id": "scanner-001",
        "phase": 1,
        "pattern": "(?i)(?:^(?:sqlmap|acunetix|nikto|nessus|netsparker|nmap|dirbuster|w3af|openvas|burpsuite|webinspect|qualys|commix)(?:/|$))",
        "targets": ["USER_AGENT"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "scanner-002",
        "phase": 1,
        "pattern": "(?i)(?:^(?:zgrab|masscan|gobuster|wfuzz|hydra|metasploit|crackmapexec|zap|arachni)(?:/|$))",
        "targets": ["USER_AGENT"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "header-sql-001",
        "phase": 1,
        "pattern": "(?i)(?:[\"']\\s*(?:and|or|union|select|delete|update|insert|drop|alter)\\s+)",
        "targets": ["HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "header-sql-002",
        "phase": 1,
        "pattern": "(?i)(?:(?:=|<|>|<=|>=|<>|!=)\\s*[\\d\"']|\\b(?:and|or)\\b\\s*[\\w-]+\\s*(?:=|<|>|<=|>=|<>|!=))",
        "targets": ["HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-001",
        "phase": 1,
        "pattern": "(?i)(?:select|insert|update|delete|drop|alter)(?:[\\s\\v\\/\\*]+)(?:from|into|where|table)\\b",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-002",
        "phase": 1,
        "pattern": "(?i)(?:union(?:[\\s\\v\\/\\*]+)(?:all|distinct|select|null))",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-003",
        "phase": 1,
        "pattern": "(?:[\"'])[\\s\\v]*(?:and|or|not|xor|div|like|between|[><]|>=|<=|!=|<>)[\\s\\v]*(?:\\d+|[\"']\\d+[\"']|(?:(?:select|union).+))",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-001",
        "phase": 1,
        "pattern": "(?i)(?:<[^>]*(?:script|img|svg|iframe|frame|embed|object|applet)[^>]*>)",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-002",
        "phase": 1,
        "pattern": "(?i)(?:on(?:abort|blur|change|click|dblclick|error|focus|keydown|keypress|keyup|load|mouse|move|reset|resize|select|submit|unload)\\s*=)",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "path-001",
        "phase": 1,
        "pattern": "(?:\\.\\.[/\\\\]|\\.\\./|\\.\\.\\\\/|%2e%2e[/\\\\]|%2e%2e/|%2e%2e%5c|%252e%252e)",
        "targets": ["ARGS", "PATH", "URI", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "rce-001",
        "phase": 1,
        "pattern": "(?i)(?:[;|`]\\s*[\\w\\-]+\\s*[=\\s]|[;|`]\\s*[\\w\\-]+=.*?\\$\\(|[;|`]\\s*[\\w\\-]+\\s*\\$\\()",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "log4j-001",
        "phase": 1,
        "pattern": "(?i)(?:\\$\\{(?:jndi|java|sys|env|::|lower|upper|logger|ctx|date|threadcontext|marker):.*?\\}|\\$\\{\\$\\{.*?\\}\\})",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "protocol-001",
        "phase": 1,
        "pattern": "(?i)(?:/\\.git/(?:HEAD|index|config|refs)|/\\.env(?:\\.local|\\.dev|\\.prod)?$|/\\.htaccess$|/\\.htpasswd$|/\\.svn/|/\\.DS_Store$)",
        "targets": ["PATH", "URI"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    }
]
