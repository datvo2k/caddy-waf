[
    {
        "id": "whitelist-root",
        "phase": 1,
        "pattern": "^/$",
        "targets": ["PATH"],
        "severity": "LOW",
        "action": "pass",
        "score": 0,
        "description": "Allow requests to the root path."
    },
    {
        "id": "whitelist-health",
        "phase": 1,
        "pattern": "^/(?:about|health|status|ping)$",
        "targets": ["PATH"],
        "severity": "LOW",
        "action": "pass",
        "score": 0,
        "description": "Allow requests to common health and status endpoints."
    },
    {
        "id": "scanner-detection",
        "phase": 1,
        "pattern": "(?i)(?:sqlmap|acunetix|nikto|nessus|netsparker|nmap|dirbuster|w3af|openvas|burpsuite|webinspect|qualys|commix|zap|arachni|gobuster|hydra|metasploit|zgrab|masscan|wfuzz|crackmapexec)",
        "targets": ["USER_AGENT"],
        "severity": "CRITICAL",
        "action": "block",
        "score": 10,
        "description": "Block requests from known security scanners based on User-Agent."
    },
    {
        "id": "sql-injection",
        "phase": 2,
        "pattern": "(?i)(?:\\b(?:select|insert|update|delete|drop|alter)\\b[\\s\\S]*?\\b(?:from|into|where|table)\\b|\\bunion\\b[\\s\\S]*?\\bselect\\b|'\\s*(?:and|or)\\s*['\\d]+\\s*(?:=|[<>]=?|!=)\\s*['\\d]+|\\)\\s*(?:and|or)\\s*\\([\\d]+\\s*(?:=|[<>]=?|!=)\\s*[\\d]+\\)|\\b(?:sleep|benchmark|waitfor\\s+delay)\\s*\\()",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block SQL injection attempts in request arguments, body, and headers."
    },
    {
        "id": "xss",
        "phase": 2,
        "pattern": "(?i)(?:<script[^>]*>|<img[^>]*\\s+onerror=|javascript:|<svg[^>]*\\s+onload=|alert\\(|document\\.cookie|eval\\(|base64_decode)",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block XSS attempts using HTML tags, event handlers, and javascript: protocol."
    },
    {
        "id": "path-traversal",
        "phase": 2,
        "pattern": "(?:\\.\\.[/\\\\]|\\.\\./|\\.\\.\\\\/|%2e%2e[/\\\\]|%2e%2e/|%2e%2e%5c|%252e%252e|\\b(?:etc/passwd|etc/shadow|proc/self/environ)\\b)",
        "targets": ["PATH", "ARGS", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block path traversal attempts and direct access to sensitive files."
    },
    {
        "id": "rce",
        "phase": 2,
        "pattern": "(?i)(?:\\b(?:cat|base64|whoami)\\b[\\s\\S]*?\\b(?:/etc/passwd|/etc/shadow)\\b|`[^`]+`|;\\s*[\\w\\-]+\\s*[=\\s]|;\\s*[\\w\\-]+=.*?\\$\\(|;\\s*[\\w\\-]+\\s*\\$\\()",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block remote code execution attempts using command separators, backticks, and base64-encoded commands."
    },
    {
        "id": "log4j-exploit",
        "phase": 2,
        "pattern": "(?i)(?:\\$\\{jndi:(?:ldap|rmi|dns|iiop|corba|nds|nis|http)://[^}]+\\}|\\$\\{(?:env|sys|java|lower|upper|logger|ctx|date|threadcontext|marker):[^}]+\\})",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block Log4j exploit attempts using JNDI and environment variables."
    },
    {
        "id": "header-attacks",
        "phase": 2,
        "pattern": "(?i)(?:1'\\s+OR\\s+'1'='1|<script[^>]*>|../../etc/passwd|1'\\s+UNION\\s+SELECT\\s+NULL--)",
        "targets": ["HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block SQL injection, XSS, and path traversal attempts in headers."
    },
    {
        "id": "sensitive-files",
        "phase": 1,
        "pattern": "(?i)(?:/\\.git/(?:HEAD|index|config|refs)|/\\.env(?:\\.local|\\.dev|\\.prod)?$|/\\.htaccess$|/\\.htpasswd$|/\\.svn/|/\\.DS_Store$)",
        "targets": ["PATH", "URI"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "description": "Block access to sensitive files and directories."
    },
    {
        "id": "unusual-paths",
        "phase": 1,
        "pattern": "(?i)(?:/wp-admin|/phpmyadmin|/admin|/login|/cgi-bin|/shell|/backdoor|/cmd|/exec|/bin/sh|/bin/bash)",
        "targets": ["PATH"],
        "severity": "MEDIUM",
        "action": "block",
        "score": 3,
        "description": "Block requests to unusual or suspicious paths."
    }
]
