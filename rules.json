[
    {
        "id": "sql-001",
        "phase": 1,
        "pattern": "(?i)\\b(select|insert|update|delete|drop|alter)\\b.*?\\b(from|into|where|table)\\b",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-002",
        "phase": 1,
        "pattern": "(?i)\\b(union)\\b.*?\\b(select|all|distinct)\\b",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-003",
        "phase": 1,
        "pattern": "['\\\"][\\s\\v]*?(?:or|and|like|between|\\&\\&|\\|\\|)[\\s\\v]*?[\\w'\\\"]+=*?[\\w'\\\"]",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-004",
        "phase": 1,
        "pattern": "(?i)\\((select|delete|update|insert|drop|union)\\b",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "sql-005",
        "phase": 1,
        "pattern": "(?i)(sleep|benchmark|pg_sleep|wait\\s+for\\s+delay)\\s*\\([^)]*\\)",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-001",
        "phase": 1,
        "pattern": "(?i)<[^>]*script[^>]*>.*?</[^>]*script[^>]*>",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-002",
        "phase": 1,
        "pattern": "(?i)\\b(on\\w+)\\s*=",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-003",
        "phase": 1,
        "pattern": "(?i)(javascript|vbscript|expression|data)\\s*:",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "xss-004",
        "phase": 1,
        "pattern": "(?i)<[^>]*\\b(onload|onerror|onmouseover|onmouseout|onmousemove|onclick|ondblclick|onkeydown|onkeypress|onkeyup|onblur|onfocus|onsubmit|onreset|onselect|onchange|ondrag|ondrop)\\b",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "path-001",
        "phase": 1,
        "pattern": "\\.\\.(\\\\|\\/|\\.|\\.\\\\|\\.\\/)([\\.\\/\\\\])*",
        "targets": ["ARGS", "PATH", "URI", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "path-002",
        "phase": 1,
        "pattern": "(?:%2e|%2E){2,}(?:%2f|%2F|%5c|%5C)",
        "targets": ["ARGS", "PATH", "URI", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "rce-001",
        "phase": 1,
        "pattern": "(?i)\\b(?:system|exec|shell_exec|passthru|eval|assert|popen|proc_open|pcntl_exec|expect_popen)\\s*\\(",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "rce-002",
        "phase": 1,
        "pattern": "`[^`]*`|\\$\\([^)]*\\)|\\$\\{[^}]*\\}",
        "targets": ["ARGS", "BODY", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "log4j-001",
        "phase": 1,
        "pattern": "\\$\\{(?:jndi|java|sys|env|::|lower|upper):.*?\\}",
        "targets": ["ARGS", "BODY", "HEADERS", "COOKIES"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "protocol-001",
        "phase": 1,
        "pattern": "(?:/|\\\\)?\\.(?:git|env|htaccess|htpasswd|config|cfg|ini|bak)\\b",
        "targets": ["PATH", "URI"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "scanner-001",
        "phase": 1,
        "pattern": "(?i)(sqlmap|nikto|nessus|netsparker|nmap|dirbuster|w3af|acunetix|appscan|webinspect|burp|qualys)",
        "targets": ["USER_AGENT", "HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    },
    {
        "id": "header-001",
        "phase": 1,
        "pattern": "(?i)x-(?:attack|scan|debug|forward|original|rewrite)-",
        "targets": ["HEADERS"],
        "severity": "HIGH",
        "action": "block",
        "score": 5,
        "mode": "block"
    }
]
