# ⚙️ Configuration Options

| Option                 | Description                                                                                                                                                                                                | Example                                                                                                        |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| `anomaly_threshold`    | Sets the anomaly score threshold at which requests will be blocked.                                                                                                                                      | `anomaly_threshold 20`                                                                                     |
| `rule_file`            | Path to a JSON file containing the WAF rules.                                                                                                                                                             | `rule_file rules.json`                                                                                     |
| `ip_blacklist_file`    | Path to a file containing blacklisted IP addresses and CIDR ranges.                                                                                                                                       | `ip_blacklist_file blacklist.txt`                                                                            |
| `dns_blacklist_file`   | Path to a file containing blacklisted domain names.                                                                                                                                                     | `dns_blacklist_file domains.txt`                                                                             |
| `rate_limit`           | Configures the rate limiting parameters. The syntax is `requests`, `window`, and optional `cleanup_interval`.  Use `paths` to set specific paths to rate limit, and `match_all_paths` to specify if only matching paths should be rate limited (`false`), or all paths except matching should be rate limited (`true`).   | `rate_limit { requests 100 window 1m cleanup_interval 5m paths /api/v1/.* /admin/.* match_all_paths false }`            |
| `block_countries`      | Enables country blocking, requires the GeoIP database path and ISO country codes.                                                                                                                          | `block_countries GeoLite2-Country.mmdb RU CN KP`                                                              |
| `whitelist_countries`  | Enables country whitelisting, requires the GeoIP database path and ISO country codes.                                                                                                                      | `whitelist_countries GeoLite2-Country.mmdb US`                                                              |
| `log_severity`         | Sets the minimum logging level (`debug`, `info`, `warn`, `error`).                                                                                                                                      | `log_severity debug`                                                                                        |
| `log_json`             | Enables JSON formatted log output.                                                                                                                                                                       | `log_json`                                                                                                   |
| `log_path`             | Sets the path for the log file. If not specified, it will default to `/var/log/caddy/waf.json`.                                                                                                             | `log_path debug.json`                                                                                       |
| `redact_sensitive_data` | When enabled, it will redact sensitive data from the query string on the logs.                                                                                                                             | `redact_sensitive_data`                                                                                       |
| `custom_response`      | Defines a custom response for the specified status code, following the syntax `custom_response STATUS_CODE content_type body_string_or_file_path`. Can load from a file or use a plain text string as response.  | `custom_response 403 application/json error.json` or `custom_response 403 text/html "<h1>Access Denied</h1>"`   |
```

